# GHOST 프레임워크

> **Generated Human-like Orchestrated Stress Test**

## GHOST의 본질

**wiiiv의 품질을 인간 수준 자연스러움까지 끌어올리는 적대적 대화 시뮬레이터**

### 기존 HST와의 결정적 차이

| 구분 | HST | GHOST |
|---|---|---|
| 사람 역할 | 대본 낭독 | **즉흥 연기** |
| 목적 | "이 경로가 작동하는가" | **"인간이 쓰면 어떻게 되는가"** |
| 난이도 | 설계자가 통제 | **LLM이 스스로 가혹하게** |
| 실패 시 | 테스트 스크립트 수정 | **엔진 수정** |
| 반복 | 같은 메시지 재실행 | **매번 다른 대화, 같은 목표** |

### 핵심 원칙

1. **wiiiv는 상대가 LLM인 줄 모른다** — 진짜 사용자 경험을 시뮬레이션
2. **인간의 불완전함을 재현한다** — 오타, 모호한 지시, 갑자기 주제 변경, "아 그거 아니고", 중간에 딴소리
3. **간단한 건 의미 없다** — 복잡하고 모호하고 가혹한 시나리오만 가치가 있다
4. **매 실행이 개선 루프다** — GHOST 실행 → 엔진 버그 발견 → 수정 → 커밋/푸시 → 다른 시나리오 → 반복
5. **궁극 목표는 "어색함 제로"** — 인간이 일상 업무에서 하는 모든 작업을 wiiiv와 함께 할 때, 부자연스러운 순간이 단 한 번도 없는 상태

### 도달점

GHOST를 통과한 wiiiv는 — 사용자가 "아 이거 AI랑 대화하는 거구나"라고 느끼는 순간이 없어야 합니다. 실수해도 자연스럽게 받아주고, 모호해도 올바르게 물어보고, 급하면 빠르게 처리하고, 복잡하면 체계적으로 정리하는 — **업무 파트너**.

---

## 케이스 형식

기존 HST: `Turn[]` 배열 (메시지 하드코딩)
GHOST: **시나리오 문서** (목표 + 제약 + 페르소나만)

### 예시: PX-C03

```
PX-C03: 김현수 팀장의 긴급 야근
- 페르소나: 급하고 짜증남, 오타 많음, 중간에 딴소리
- 목표: skystock CRITICAL 알림 → 공급사 확인 → 긴급 발주 워크플로우
- 제약: 반드시 cancel 1회 이상, 인증정보를 처음에 안 줌
- 턴 규모: 30~40
- 판정: 워크플로우 실행 성공 + 저장 완료
```

매 실행마다 **다른 대화**를 하되 같은 목표를 달성하므로, 비결정적 테스트가 됩니다.

---

## 구현: ghost-runner.py

기존 `hst-runner.py`는 그대로 둡니다 (회귀 테스트용). `ghost-runner.py`를 새로 만듭니다. 구조가 근본적으로 다릅니다:

```
ghost-runner.py
  → 시나리오 읽기
  → wiiiv 세션 생성
  → [루프] 서버 응답 읽기 → Claude가 다음 메시지 생성 → SSE 전송
  → 목표 달성 판정
  → 결과 기록
```

"Claude가 다음 메시지 생성"은 직접이 아니라, **ghost-runner.py 안에서 LLM API를 호출**합니다. 그래야 `고스트돌려` 한마디에 자동으로 돌아갑니다.

---

## 디렉토리 구조

```
wiiiv/ghost/
├── ghost.md           ← 이 문서 (GHOST 사양서)
├── cases/             ← 시나리오 문서들 (PX-C01.md, PX-C02.md, ...)
├── results/           ← 실행 결과 로그
└── ghost-runner.py    ← GHOST 실행기
```

---

## 수렴 조건

**케이스가 첫 실행에 무수정 PASS → 그 영역은 안정화된 것**

처음에는 매 케이스마다 엔진 버그가 터지고 수정이 많지만, 회차가 쌓이면 점점 수정 없이 통과하는 비율이 높아집니다. **무수정 PASS가 당연해지는 상태**가 GHOST의 도달점입니다.
